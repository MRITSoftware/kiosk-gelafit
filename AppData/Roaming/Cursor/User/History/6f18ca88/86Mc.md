# ğŸ—‚ï¸ Estrutura do Banco de Dados - VisÃ£o Completa

## ğŸ“Š Diagrama de Relacionamentos

### ğŸ¢ MÃ³dulo Principal (Multi-Tenant)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   clients   â”‚ â† Cliente (empresa)
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 1:N
       â”‚
       â”œâ”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚    â”‚      users      â”‚ â† UsuÃ¡rios do cliente
       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚    â”‚    documents    â”‚ â† Documentos do cliente
       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚             â”‚ 1:N
       â”‚             â”œâ”€â”€â†’ comments
       â”‚             â”œâ”€â”€â†’ favorites
       â”‚             â”œâ”€â”€â†’ signatures
       â”‚             â”œâ”€â”€â†’ annotations
       â”‚             â””â”€â”€â†’ shares
       â”‚
       â”œâ”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚    â”‚     folders     â”‚ â† Pastas (hierÃ¡rquicas)
       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚    â”‚      tags       â”‚ â† Tags de categorizaÃ§Ã£o
       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚    â”‚   workflows     â”‚ â† Workflows de aprovaÃ§Ã£o
       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â””â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ client_settings â”‚ â† ConfiguraÃ§Ãµes do cliente
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ Estrutura Detalhada por MÃ³dulo

### 1. ğŸ‘¤ MÃ³dulo de UsuÃ¡rios

```
users
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ email (Ãºnico)
â”œâ”€â”€ name
â”œâ”€â”€ password_hash
â”œâ”€â”€ role (enum: super_admin, client_admin, client_collaborator)
â”œâ”€â”€ client_id (FK â†’ clients)
â”œâ”€â”€ avatar
â”œâ”€â”€ is_active
â”œâ”€â”€ created_at
â””â”€â”€ updated_at

user_preferences (1:1 com users)
â”œâ”€â”€ user_id (PK, FK)
â”œâ”€â”€ language
â”œâ”€â”€ timezone
â”œâ”€â”€ notifications (JSONB)
â””â”€â”€ display (JSONB)

user_invites
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ email
â”œâ”€â”€ role
â”œâ”€â”€ client_id (FK)
â”œâ”€â”€ invited_by (FK â†’ users)
â”œâ”€â”€ token (Ãºnico)
â”œâ”€â”€ expires_at
â””â”€â”€ is_used
```

**Regras:**
- âœ… Super Admin: `client_id = NULL`
- âœ… Admin e Colaborador: `client_id` obrigatÃ³rio
- âœ… Email Ãºnico no sistema
- âœ… PreferÃªncias criadas automaticamente via trigger

---

### 2. ğŸ“„ MÃ³dulo de Documentos

```
documents
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ title
â”œâ”€â”€ description
â”œâ”€â”€ file_name
â”œâ”€â”€ file_size (bytes)
â”œâ”€â”€ file_type (MIME type)
â”œâ”€â”€ file_path
â”œâ”€â”€ file_data (Base64, opcional para preview)
â”œâ”€â”€ version (integer, default 1)
â”œâ”€â”€ status (enum: pending, in_review, approved, rejected)
â”œâ”€â”€ client_id (FK â†’ clients) â† ISOLAMENTO MULTI-TENANT
â”œâ”€â”€ uploaded_by (FK â†’ users)
â”œâ”€â”€ folder_id (FK â†’ folders, nullable)
â”œâ”€â”€ thumbnail_url
â”œâ”€â”€ ocr_text (texto extraÃ­do, indexado para busca)
â”œâ”€â”€ metadata (JSONB)
â”œâ”€â”€ workflow_instance_id (FK, nullable)
â”œâ”€â”€ expires_at (nullable)
â”œâ”€â”€ download_count (default 0)
â”œâ”€â”€ view_count (default 0)
â”œâ”€â”€ created_at
â””â”€â”€ updated_at

document_tags (N:M)
â”œâ”€â”€ document_id (FK)
â””â”€â”€ tag_id (FK)

document_metadata (JSONB)
{
  "author": "string",
  "subject": "string",
  "keywords": ["array"],
  "pageCount": number,
  "language": "string",
  "customFields": {}
}
```

**Ãndices:**
- âœ… `client_id` (filtros)
- âœ… `uploaded_by` (meus documentos)
- âœ… `folder_id` (documentos por pasta)
- âœ… `status` (pendentes, aprovados, etc)
- âœ… `created_at DESC` (mais recentes)
- âœ… `title` (busca full-text)
- âœ… `ocr_text` (busca em conteÃºdo)

---

### 3. ğŸ“‚ MÃ³dulo de OrganizaÃ§Ã£o

```
folders (estrutura hierÃ¡rquica)
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ name
â”œâ”€â”€ description
â”œâ”€â”€ client_id (FK â†’ clients) â† ISOLAMENTO
â”œâ”€â”€ parent_id (FK â†’ folders, self-reference) â† HIERARQUIA
â”œâ”€â”€ created_at
â””â”€â”€ updated_at

tags
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ name
â”œâ”€â”€ color (HEX: #RRGGBB)
â”œâ”€â”€ client_id (FK â†’ clients) â† ISOLAMENTO
â””â”€â”€ created_at

Constraint: UNIQUE(name, client_id)
```

**Exemplos de Hierarquia:**
```
ğŸ“ RH
  â”œâ”€â”€ ğŸ“ Folha de Pagamento
  â”œâ”€â”€ ğŸ“ AdmissÃµes
  â””â”€â”€ ğŸ“ FÃ©rias

ğŸ“ Documentos Fiscais
  â”œâ”€â”€ ğŸ“ 2024
  â”‚   â”œâ”€â”€ ğŸ“ Janeiro
  â”‚   â””â”€â”€ ğŸ“ Fevereiro
  â””â”€â”€ ğŸ“ 2023
```

---

### 4. ğŸ’¬ MÃ³dulo de ComunicaÃ§Ã£o

```
comments
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ document_id (FK â†’ documents)
â”œâ”€â”€ user_id (FK â†’ users)
â”œâ”€â”€ content (text)
â”œâ”€â”€ is_internal (boolean) â† Admin vs pÃºblico
â”œâ”€â”€ reply_to (FK â†’ comments, self-reference) â† THREADS
â”œâ”€â”€ is_edited (boolean)
â”œâ”€â”€ created_at
â””â”€â”€ updated_at

comment_mentions (N:M)
â”œâ”€â”€ comment_id (FK)
â””â”€â”€ user_id (FK)

chat_messages
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ document_id (FK, nullable)
â”œâ”€â”€ client_id (FK â†’ clients) â† ISOLAMENTO
â”œâ”€â”€ user_id (FK â†’ users)
â”œâ”€â”€ content
â”œâ”€â”€ attachments (array de URLs)
â”œâ”€â”€ reply_to (FK, self-reference)
â”œâ”€â”€ is_edited
â”œâ”€â”€ created_at
â””â”€â”€ updated_at

chat_message_mentions (N:M)
â”œâ”€â”€ message_id (FK)
â””â”€â”€ user_id (FK)

reactions
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ target_type (enum: comment, message)
â”œâ”€â”€ target_id (UUID)
â”œâ”€â”€ user_id (FK)
â”œâ”€â”€ emoji (varchar)
â””â”€â”€ created_at

Constraint: UNIQUE(target_type, target_id, user_id, emoji)
```

**Funcionalidades:**
- âœ… ComentÃ¡rios hierÃ¡rquicos (respostas)
- âœ… MenÃ§Ãµes (@usuario)
- âœ… ComentÃ¡rios internos (sÃ³ admin vÃª)
- âœ… EdiÃ§Ã£o de comentÃ¡rios
- âœ… ReaÃ§Ãµes com emojis
- âœ… Chat por cliente ou por documento

---

### 5. ğŸ”” MÃ³dulo de NotificaÃ§Ãµes

```
notifications
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ user_id (FK â†’ users)
â”œâ”€â”€ type (enum: document_uploaded, status_changed, mention, etc)
â”œâ”€â”€ title
â”œâ”€â”€ message
â”œâ”€â”€ priority (enum: low, medium, high, urgent)
â”œâ”€â”€ is_read (boolean, default false)
â”œâ”€â”€ link (URL, nullable)
â”œâ”€â”€ metadata (JSONB)
â””â”€â”€ created_at

Tipos de notificaÃ§Ã£o:
- document_uploaded
- document_commented
- status_changed
- user_invited
- document_shared
- document_signed
- mention
- workflow_assigned
- approval_pending
- chat_message
- sla_warning
```

**Ãndices:**
- âœ… `user_id` (minhas notificaÃ§Ãµes)
- âœ… `is_read` (nÃ£o lidas)
- âœ… `created_at DESC` (mais recentes primeiro)

---

### 6. ğŸ”„ MÃ³dulo de Workflows

```
workflows
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ name
â”œâ”€â”€ description
â”œâ”€â”€ client_id (FK â†’ clients) â† ISOLAMENTO
â”œâ”€â”€ is_active (boolean)
â”œâ”€â”€ created_at
â””â”€â”€ updated_at
    â”‚
    â””â”€â†’ workflow_steps (1:N)
        â”œâ”€â”€ id (UUID, PK)
        â”œâ”€â”€ workflow_id (FK)
        â”œâ”€â”€ order_index (integer) â† ORDEM DOS STEPS
        â”œâ”€â”€ name
        â”œâ”€â”€ approver_role (enum, nullable)
        â”œâ”€â”€ require_all (boolean) â† Todos aprovam ou apenas um?
        â”œâ”€â”€ sla_hours (integer, nullable)
        â”œâ”€â”€ auto_escalate (boolean)
        â””â”€â”€ created_at
            â”‚
            â””â”€â†’ workflow_step_approvers (N:M)
                â”œâ”€â”€ step_id (FK)
                â””â”€â”€ user_id (FK)

workflow_instances
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ workflow_id (FK â†’ workflows)
â”œâ”€â”€ document_id (FK â†’ documents)
â”œâ”€â”€ current_step_index (integer)
â”œâ”€â”€ status (enum: in_progress, completed, cancelled)
â”œâ”€â”€ started_at
â””â”€â”€ completed_at
    â”‚
    â””â”€â†’ workflow_step_instances (1:N)
        â”œâ”€â”€ id (UUID, PK)
        â”œâ”€â”€ workflow_instance_id (FK)
        â”œâ”€â”€ step_id (FK â†’ workflow_steps)
        â”œâ”€â”€ status (enum: pending, in_progress, approved, rejected)
        â”œâ”€â”€ started_at
        â”œâ”€â”€ completed_at
        â””â”€â”€ sla_deadline
            â”‚
            â”œâ”€â†’ workflow_step_assignees (N:M)
            â”‚   â”œâ”€â”€ step_instance_id (FK)
            â”‚   â””â”€â”€ user_id (FK)
            â”‚
            â””â”€â†’ workflow_approvals (1:N)
                â”œâ”€â”€ id (UUID, PK)
                â”œâ”€â”€ step_instance_id (FK)
                â”œâ”€â”€ user_id (FK)
                â”œâ”€â”€ action (enum: approved, rejected)
                â”œâ”€â”€ comment (text, nullable)
                â””â”€â”€ approved_at
```

**Exemplo de Workflow:**

```
Workflow: "AprovaÃ§Ã£o de Contratos"
  â”‚
  â”œâ”€ Step 1: RevisÃ£o Inicial
  â”‚    â”œâ”€ Aprovador: Admin do Cliente
  â”‚    â”œâ”€ SLA: 24 horas
  â”‚    â””â”€ Require All: false (qualquer admin)
  â”‚
  â””â”€ Step 2: AprovaÃ§Ã£o Final
       â”œâ”€ Aprovador: Admin EspecÃ­fico
       â”œâ”€ SLA: 48 horas
       â””â”€ Require All: true (todos devem aprovar)
```

---

### 7. ğŸ“‹ MÃ³dulo de Auditoria e Analytics

```
audit_logs
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ user_id (FK â†’ users)
â”œâ”€â”€ action (varchar) â† "document.created", "user.updated", etc
â”œâ”€â”€ resource_type (varchar) â† "document", "user", "folder", etc
â”œâ”€â”€ resource_id (varchar)
â”œâ”€â”€ metadata (JSONB)
â”œâ”€â”€ client_id (FK, nullable)
â””â”€â”€ created_at

activities (para analytics)
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ user_id (FK)
â”œâ”€â”€ client_id (FK) â† ISOLAMENTO
â”œâ”€â”€ type (varchar) â† "document_view", "document_download", etc
â”œâ”€â”€ resource_type (varchar)
â”œâ”€â”€ resource_id (varchar)
â”œâ”€â”€ metadata (JSONB)
â””â”€â”€ timestamp

Exemplos de actions em audit_logs:
- document.created
- document.updated
- document.deleted
- document.status_changed
- user.created
- user.updated
- user.deleted
- folder.created
- comment.created
- workflow.started
- workflow.completed
```

**Ãndices:**
- âœ… `user_id` (aÃ§Ãµes do usuÃ¡rio)
- âœ… `client_id` (aÃ§Ãµes do cliente)
- âœ… `resource_type` (filtrar por tipo)
- âœ… `created_at DESC` (mais recentes)

---

### 8. ğŸ”— MÃ³dulo de Compartilhamento

```
shares
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ document_id (FK â†’ documents)
â”œâ”€â”€ shared_by (FK â†’ users)
â”œâ”€â”€ token (varchar, Ãºnico) â† Link pÃºblico: /share/{token}
â”œâ”€â”€ password (text, nullable, hash) â† ProteÃ§Ã£o opcional
â”œâ”€â”€ expires_at (timestamp, nullable) â† Link temporÃ¡rio
â”œâ”€â”€ max_downloads (integer, nullable) â† Limite de downloads
â”œâ”€â”€ download_count (integer, default 0)
â”œâ”€â”€ is_active (boolean, default true)
â””â”€â”€ created_at

favorites (N:M)
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ user_id (FK)
â”œâ”€â”€ document_id (FK)
â””â”€â”€ created_at

Constraint: UNIQUE(user_id, document_id)
```

---

### 9. âœï¸ MÃ³dulo de Assinaturas

```
signatures
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ document_id (FK â†’ documents)
â”œâ”€â”€ user_id (FK â†’ users)
â”œâ”€â”€ signature_data (text) â† Base64 da assinatura
â”œâ”€â”€ ip_address (varchar)
â”œâ”€â”€ user_agent (text)
â”œâ”€â”€ certificate_info (JSONB, nullable)
â””â”€â”€ signed_at

annotations
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ document_id (FK â†’ documents)
â”œâ”€â”€ user_id (FK â†’ users)
â”œâ”€â”€ content (text)
â”œâ”€â”€ position (JSONB) â† {page, x, y, highlightedText}
â”œâ”€â”€ resolved (boolean, default false)
â”œâ”€â”€ created_at
â””â”€â”€ updated_at

position (JSONB)
{
  "page": 1,
  "x": 100,
  "y": 200,
  "highlightedText": "texto selecionado"
}
```

---

### 10. ğŸ“ MÃ³dulo de Templates

```
document_templates
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ name
â”œâ”€â”€ description
â”œâ”€â”€ client_id (FK â†’ clients) â† ISOLAMENTO
â”œâ”€â”€ file_data (text) â† Base64 ou URL
â”œâ”€â”€ category (varchar)
â”œâ”€â”€ created_at
â””â”€â”€ updated_at

template_tags (N:M)
â”œâ”€â”€ template_id (FK)
â””â”€â”€ tag_id (FK)
```

---

### 11. âš™ï¸ MÃ³dulo de ConfiguraÃ§Ãµes

```
client_settings (1:1 com clients)
â”œâ”€â”€ client_id (PK, FK)
â”œâ”€â”€ theme (JSONB)
â”œâ”€â”€ features (JSONB)
â”œâ”€â”€ notifications (JSONB)
â”œâ”€â”€ security (JSONB)
â”œâ”€â”€ storage (JSONB)
â”œâ”€â”€ created_at
â””â”€â”€ updated_at

theme (JSONB)
{
  "primaryColor": "#4F46E5",
  "secondaryColor": "#9333EA",
  "logo": "url",
  "favicon": "url"
}

features (JSONB)
{
  "enableChat": true,
  "enableWorkflows": true,
  "enableSignatures": true,
  "enableOCR": true,
  "enableVersionComparison": true
}

security (JSONB)
{
  "requireMfa": false,
  "sessionTimeout": 30,
  "passwordPolicy": {
    "minLength": 8,
    "requireUppercase": true,
    "requireNumbers": true,
    "requireSpecialChars": true
  }
}

storage (JSONB)
{
  "maxFileSize": 104857600,
  "allowedFileTypes": ["pdf", "doc", "docx", "jpg", "png"],
  "quota": 10737418240,
  "usedSpace": 0
}
```

---

## ğŸ”’ PolÃ­ticas de SeguranÃ§a (RLS)

### Hierarquia de Acesso

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SUPER ADMIN    â”‚ â† Acesso TOTAL a tudo
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â†’ VÃª todos os clientes
         â”œâ”€â†’ Gerencia todos os usuÃ¡rios
         â”œâ”€â†’ Acessa todos os documentos
         â””â”€â†’ VÃª todos os logs

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CLIENT ADMIN   â”‚ â† Acesso ao prÃ³prio cliente
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â†’ VÃª dados do prÃ³prio cliente
         â”œâ”€â†’ Gerencia usuÃ¡rios do cliente
         â”œâ”€â†’ Aprova/rejeita documentos
         â”œâ”€â†’ Gerencia pastas e tags
         â””â”€â†’ VÃª logs do cliente

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ COLLABORATOR    â”‚ â† Acesso limitado
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â†’ VÃª documentos do cliente
         â”œâ”€â†’ Faz upload de documentos
         â”œâ”€â†’ Comenta em documentos
         â”œâ”€â†’ Edita prÃ³prios documentos
         â””â”€â†’ VÃª notificaÃ§Ãµes prÃ³prias
```

### PolÃ­ticas Implementadas

#### 1. Isolamento Multi-Tenant
```sql
-- UsuÃ¡rios sÃ³ veem dados do prÃ³prio client_id
USING (
  client_id IN (
    SELECT client_id FROM users
    WHERE users.id = auth.uid()
  )
)
```

#### 2. Documentos
```sql
-- SELECT: Ver documentos do prÃ³prio cliente
-- INSERT: Criar documentos no prÃ³prio cliente
-- UPDATE: Admin ou uploader pode editar
-- DELETE: Apenas admin
```

#### 3. ComentÃ¡rios
```sql
-- SELECT: Ver comentÃ¡rios de docs do cliente
-- INSERT: Criar comentÃ¡rios em docs do cliente
-- UPDATE/DELETE: Apenas prÃ³prios comentÃ¡rios
```

#### 4. NotificaÃ§Ãµes
```sql
-- UsuÃ¡rios veem apenas prÃ³prias notificaÃ§Ãµes
USING (user_id = auth.uid())
```

---

## ğŸ“ˆ Views Ãšteis

### documents_with_details
Documentos com informaÃ§Ãµes relacionadas (uploader, pasta, tags, contadores)

```sql
SELECT 
  d.*,
  u.name as uploaded_by_name,
  f.name as folder_name,
  c.name as client_name,
  COUNT(comments) as comment_count,
  COUNT(favorites) as favorite_count,
  array_agg(tags.name) as tag_names
FROM documents d
LEFT JOIN users u ON ...
LEFT JOIN folders f ON ...
...
```

### recent_activities
Ãšltimas 100 atividades do sistema

```sql
SELECT 
  a.*,
  u.name as user_name,
  c.name as client_name
FROM activities a
...
ORDER BY timestamp DESC
LIMIT 100
```

---

## ğŸ¯ FunÃ§Ãµes Auxiliares

### search_documents(search_query, client_id)
Busca full-text em documentos (tÃ­tulo, descriÃ§Ã£o, OCR)

```sql
SELECT * FROM search_documents('contrato', 'client-uuid');
```

### get_client_stats(client_id)
Retorna estatÃ­sticas do cliente

```json
{
  "total_users": 10,
  "total_documents": 50,
  "total_folders": 5,
  "storage_used": 10485760,
  "documents_by_status": {
    "pending": 10,
    "approved": 30,
    "rejected": 5,
    "in_review": 5
  }
}
```

---

## ğŸ”„ Triggers AutomÃ¡ticos

### updated_at
Atualiza automaticamente o campo `updated_at` em:
- clients
- users
- folders
- documents
- comments
- workflows
- chat_messages
- annotations
- document_templates
- client_settings
- user_preferences

### ConfiguraÃ§Ãµes AutomÃ¡ticas
- âœ… Ao criar cliente â†’ Cria `client_settings` automaticamente
- âœ… Ao criar usuÃ¡rio â†’ Cria `user_preferences` automaticamente

---

## ğŸ“Š Resumo de Tabelas

| Categoria | Tabelas |
|-----------|---------|
| ğŸ‘¤ UsuÃ¡rios | `users`, `user_preferences`, `user_invites` |
| ğŸ“„ Documentos | `documents`, `document_tags`, `document_templates`, `template_tags` |
| ğŸ“‚ OrganizaÃ§Ã£o | `folders`, `tags` |
| ğŸ’¬ ComunicaÃ§Ã£o | `comments`, `comment_mentions`, `chat_messages`, `chat_message_mentions`, `reactions` |
| ğŸ”” NotificaÃ§Ãµes | `notifications` |
| ğŸ”„ Workflows | `workflows`, `workflow_steps`, `workflow_step_approvers`, `workflow_instances`, `workflow_step_instances`, `workflow_step_assignees`, `workflow_approvals` |
| ğŸ”— Compartilhamento | `shares`, `favorites` |
| âœï¸ Assinaturas | `signatures`, `annotations` |
| ğŸ“‹ Auditoria | `audit_logs`, `activities` |
| âš™ï¸ ConfiguraÃ§Ãµes | `client_settings`, `clients` |

**Total: 33 tabelas**

---

## ğŸ¨ Enums Definidos

```sql
user_role:
- super_admin
- client_admin
- client_collaborator

document_status:
- pending
- in_review
- approved
- rejected

notification_type:
- document_uploaded
- document_commented
- status_changed
- user_invited
- document_shared
- document_signed
- mention
- workflow_assigned
- approval_pending
- chat_message
- sla_warning

notification_priority:
- low
- medium
- high
- urgent

workflow_status:
- in_progress
- completed
- cancelled

workflow_step_status:
- pending
- in_progress
- approved
- rejected

approval_action:
- approved
- rejected

reaction_target_type:
- comment
- message
```

---

**Desenvolvido com ğŸ’œ para um sistema enterprise de alto nÃ­vel!**


